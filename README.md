[![Python](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/release/python-380/)
[![MIT License](https://img.shields.io/badge/license-MIT-green)](https://opensource.org/licenses/MIT)
[![Status](https://img.shields.io/badge/status-Active-success)](#)

# **קידוד משולב מקור/ערוץ של חישה היפר-ספקטרלית**

---

## תקציר

פרויקט זה עוסק בפיתוח אלגוריתם לדחיסת תמונה היפרספקטרלית ולתיקון שגיאות בערוץ לווייני רועש.האלגוריתם מיועד לננו-לוויין המצויד במצלמה היפרספקטרלית, המאפשרת צילום במספר אורכי גל לצורך זיהוי חתימות ספקטרליות של מזהמים באטמוספירה ועל הקרקע.
רוחב הסרט המוגבל וזמן החליפה הקצר מעל תחנת הקרקע מחייבים דחיסת מידע בחלל לפני שידורו לכדור הארץ. מצד שני, דחיסת המידע מגדילה את רגישותו לשגיאות בערוץ ועלולה לגרום לשגיאה קטסטרופלית במהלך הפיענוח. האלגוריתם שלנו מאפשר שליטה בפרמטרים 
שונים של הדוחס ושל הצופן לתיקון שגיאות בהתאם לחשיבות המידע הנדחס, על מנת להגיע לאופטימיזציה של קריטריון ביצועים משולב של דחיסה מצד אחד ועמידות לשגיאות מצד שני בתנאי הסתברות שגיאה שונים בערוץ הלווייני בו משודר המידע מהלוויין לכדוה"א. 
ביצועי האלגוריתם נבחנו על גבי בסיס נתונים של לווייני חישה מרחוק. 
<p align="center">
<img src="Smallerdiagram.png" alt="Workflow Diagram" width="1000">
</p>

---

## מטרות הפרויקט

1. **דחיסת מידע אמינה**: פיתוח אלגוריתם דחיסה חסרת עיוות, המאפשר שחזור מלא של המידע המקורי.  
2. **תיקון שגיאות בערוץ רועש**: שילוב קוד האמינג (7,4) ובדיקת CRC לתיקון שגיאות בהתאם לדרישות.  
3. **עמידה בדרישות כמותיות**:
   - יחס דחיסה: **1:4** או טוב יותר.
   - יחס שגיאות לביט (BER): **<10^(-5)** לאחר תיקון.
   - זמן עיבוד ממוצע לפיקסל: **216 ננו-שניות** או פחות.  
4. **ממשק משתמש גרפי (GUI)**: פיתוח כלי המאפשר הרצה נוחה עם פרמטרים מותאמים.

---

## תהליך העבודה

### שלב 1: דחיסת מידע
- חישוב **פרדיקטור** לכל פיקסל בהתבסס על פיקסלים שכנים.
- הפעלת **קוד האפמן** על סדרת ההפרשים בין כל פיקסל לפרדיקטור המתאים.  
- מימוש דחיסה חסרת עיוות (Lossless) המאפשרת שחזור מלא.

### שלב 2: תיקון שגיאות
- כתיבת אלגוריתם לתיקון שגיאות באמצעות **קוד האמינג (7,4)**.
- שילוב **CRC Validation** כאופציה לתיקון שגיאות במצבים מורכבים.

### שלב 3: בדיקות ביצועים
- **בדיקות כמותיות**:
  - יחס דחיסה.
  - שיעור שגיאות (BER) לאחר תיקון.
  - זמן עיבוד לפיקסל.
- שימוש בבסיס נתונים של לווייני חישה מרחוק להערכת האלגוריתם.

### שלב 4: פיתוח ממשק משתמש
- פיתוח **GUI** עם אפשרות לבחירת פרמטרים כגון:
  - גודל התמונה.
  - שיעור שגיאות (BER).
  - שימוש אופציונלי בקוד CRC.
- כלי זה מאפשר הרצה יעילה בתרחישים מגוונים.

- נתאר את אופן מימוש הפרויקט בתוכנה לפי שלבי הקוד:
שלב 1: טעינת תמונה
מטרת שלב זה: לאפשר למשתמש להעלות תמונה היפרספקטראלית קיימת או ליצור תמונה מותאמת אישית שתשמש כקלט לתהליך הדחיסה והשחזור.
•	טעינת תמונה היפרספקטראלית: השתמשנו בפונקציה spectral.open_image לטעינת תמונה בפורמט IAN. תצוגת התמונה מתבצעת באמצעות spectral.view_cube שמספקת הצגה תלת-ממדית של התמונה.
•	יצירת תמונה מותאמת אישית: התמונה נוצרת באופן המדמה תמונה היפרספקטראלית אמיתית, תוך שילוב של גרדיאנטים מרחביים, שונות ספקטרלית ורעש. ראשית, נבנה בסיס של גרדיאנטים מרחביים באמצעות, np.outer שיוצר שינוי הדרגתי בערכי הפיקסלים על פני ממדי התמונה. לכל ערוץ (band) בתמונה מתווספת שונות ספקטרלית מחזורית, המחושבת באמצעות פונקציית סינוס (np.sin). שונות זו מדמה הבדלים בין ערוצי הספקטרום בתמונה היפרספקטראלית, כאשר כל ערוץ מקבל וריאציה ייחודית. בנוסף, לכל ערוצי התמונה מתווסף רעש אקראי, המחושב באמצעות התפלגות נורמלית  (np.random.normal) עם ממוצע 0 ורמת רעש (scale) של 0.1, כדי לדמות רעשי מדידה אופייניים. לבסוף, הערכים מותאמים לטווח [0, 17736] כדי לשמור על התאמה לערכים אופייניים בתמונות מסוג זה, תוך שימוש בפורמט float32 לצורך דיוק בעיבוד התמונה בשלבים הבאים. שילוב זה מבטיח יצירת תמונה בעלת מבנה חזותי ברור, עם וריאציה בין ערוצים ורעש טבעי, כך שהיא מהווה בסיס מצוין לבחינת אלגוריתמי דחיסה ושחזור.
שלב 2: חישוב פרדיקטור
מטרת שלב זה: לחשב פרדיקטור לפיקסלים בתמונה על בסיס מידע מפיקסלים שכנים, במטרה לצמצם את כמות המידע לדחיסה.
•	חישוב הפרדיקטור:
o	שימוש בפונקציה  np.roll להזזת המטריצה ולקבלת מיצוע שכנויות בציר X.
o	ההפרשים מחושבים בין ערכי הפיקסלים לפרדיקטור:                                                 
differences = image[:, :, :5] – predictor
•	אופטימיזציה: חישוב וקטורי מלא המאפשר עיבוד מקבילי לכלל הפיקסלים בו-זמנית, ללא לולאות. התהליך בפועל מתרחש על 5 הבאנדים בלבד. אמנם הפרדיקטור מחושב לכל הפיקסלים שבתמונה אך הדחיסה והפענוח מתבצעים על 5 באנדים נבחרים (ראשונים). הסיבה לכך היא שבננו לווין היפרספקטראלי יש ממילא מצלמה ברזולוציה יותר נמוכה מבחינת מספר הבאנדים, למשל 6 לכל היותר.
שלב 3: דחיסה באמצעות קוד האפמן
מטרת שלב זה: לדחוס את הנתונים באמצעות קוד האפמן, המייצר קודים באורך משתנה בהתאם לתדירות הערכים.
•	ניתוח התפלגות ההפרשים:
o	שימוש ב- Counter לחישוב תדירות ערכי ההפרשים.
•	בניית עץ האפמן:
o	פונקציהhuffman.codebook  יוצרת עץ קידוד שבו ערכים בתדירות גבוהה מקבלים קודים קצרים, וערכים בתדירות נמוכה יותר מקבלים קודים ארוכים יותר.
•	קידוד:
o	כתבנו פונקציה huffman_encode_bitstring שמקודדת את ההפרשים למחרוזת ביטים דחוסה.
שלב 4: קידוד ותיקון שגיאות בערוץ
מטרת שלב זה: להבטיח את עמידות הנתונים לשגיאות בערוץ באמצעות קידוד ותיקון שגיאות. 
•	הזרקת שגיאות:
o	הפונקציה introduce_errors מזריקה שגיאות אקראיות בקצב שיבחר המשתמש (error_rate).
•	קידוד האמינג ו- CRC: 
o	כתבנו פונקציות כגון: crc_encode המוסיפה 3 ביטי CRC לכל בלוק של 13 ביטים.
o	hamming_encode_vectorized מקודדת בלוק של 4 ביטים ל-7 ביטים בעזרת קוד האמינג. התהליך מבוצע וקטורית כך שבלוקים מקודדים במקביל, מה שמאיץ את התהליך.
o	בנינו פונקציה crc_hamming_encode שיודעת לבצע קידוד האמינג וקידוד CRC.
שלב 5: פענוח ושחזור התמונה
מטרת שלב זה: לפענח את הנתונים הדחוסים והשגויים ולשחזר את התמונה המקורית.
•	פענוח האמינג ו-CRC
o	כתבנו פונקציות כגון: hamming_decode_7bit לתיקון שגיאה אחת בכל בלוק של 7 ביטים. פונקציה זו עושה שימוש בוקטוריזציה חלקית בלבד: חישוב ה Syndrome -מתבצע באופן וקטורי.
o	הפונקציהcrc_check  מזהה שגיאות שפענוח האמינג לא הצליח לתקן במהלך הפענוח ודוחה בלוקים לא תקינים.
o	הפונקציה crc_hamming_decode_and_validate משלבת את התהליכים הבאים:
1.	פענוח בלוקים מקודדים באמצעות האמינג.
2.	בדיקת CRC לאימות תקינות הבלוקים.
3.	הבלוקים התקינים מתווספים לשחזור, בעוד בלוקים לא תקינים נזרקים.
o	הפונקציה מחזירה את הביטים המפוענחים התקינים, את המיקומים של בלוקים תקינים, ואת כמות הבלוקים שנפסלו עקב שגיאות.
•	פענוח האפמן:
o	הפונקציהhuffman_decode_bitstring  מפענחת את הנתונים בעזרת עץ האפמן ההפוך.
•	שחזור התמונה:
o	ההפרשים המחושבים מחוברים לערכי הפרדיקטור לשחזור הפיקסלים המקוריים:
decompressed_image = predictor + decoded_differences
שלב 6: הצגת תוצאות
מטרת שלב זה: להציג את התמונה המקורית, הדחוסה, והמשוחזרת, יחד עם ניתוח כמותי של התוצאות.
•	תצוגה חזותית:
o	שימוש ב-plt.imshow  ו- plt.subplot להצגת התמונה המקורית, ההפרשים, והתמונה המשוחזרת. בחרנו להדפיס את התמונות ב-5 אורכי גל שונים לבחירתנו, בהתבסס על רזולוציית המצלמה ההיפרספקטרלית בננו-לוויינים, שבדרך כלל מוגבלת ל-5 או 6 אורכי גל בלבד. ההדפסה נעשתה בגווני אפור, מאחר שלמדנו בקורס "הנדסת מערכות חלל" שהעין האנושית מבחינה טוב יותר בשינויים בגווני אפור, דבר שמאפשר ניתוח ברור ומדויק יותר של תוצאות הסימולציה.
•	ניתוח כמותי:
o	חישוב שיעור השגיאות (BER) באמצעות הפונקציותCalculate_Ber_NO_CRC  ו-Calculate_Ber_After_CRC.
o	חישוב זמן העיבוד הכולל, זמן העיבוד הממוצע לפיקסל ובדיקת עמידה בדרישות הכמותיות.
o	חישוב יחס הדחיסה ובדיקת עמידה בדרישה הכמותית ליחס דחיסה
o	תצוגת נתונים בטבלה באמצעות tabulate.
שלב 7: ממשק משתמש גרפי  (GUI)
מטרת שלב זה: לספק ממשק נוח המאפשר שליטה מלאה בתהליך.
מרכיבי הממשק ותפקידם:
•	הרצת התהליך: כפתור run_process מפעיל את כל שלבי הקוד, מציג תוצאות חזותיות וכמותיות, ובודק את עמידות התהליך לדרישות.
•	טעינת תמונה:
o	כפתור Load IAN Image:
מאפשר למשתמש לטעון תמונה היפרספקטראלית קיימת מתוך קובץ.
התמונה מוצגת בחלון עם פרטים (סוג נתונים, גודל בביטים, ממדים), ובתצוגה חזותית בתלת-ממד.
o	כפתור Create Image ליצירת תמונה מותאמת אישית:
מאפשר למשתמש ליצור תמונה עם ממדים מותאמים אישית, שנקבעים באמצעות שדה הזנה.
התמונה נוצרת בערכים רנדומליים בהתפלגות נורמלית, ותוצג בלוג יחד עם ממדיה.
•	בחירה בשימוש ב-CRC: מאפשר למשתמש לבחור האם לבצע/לא לבצע שימוש בקוד CRC במהלך הקידוד.
•	הגדרת קצב שגיאות: שדה הזנה Error Rate מאפשר למשתמש לקבוע את קצב השגיאות שיוזרק לנתונים, לצורך בדיקת עמידות התהליך לשגיאות.
•	איפוס התהליך: כפתור Clear מאפס את הלוג ואת מצב הממשק, ומאפשר למשתמש להתחיל תהליך חדש עם פרמטרים מעודכנים.


---

## תרשים הזרימה של התהליך

<p align="center">
<img src="diagram.png" alt="Workflow Diagram" width="800">
</p>

---

## תוצאה חזותית לדוגמה

<p align="center">
<img src="results.png" alt="Hyperspectral Image Example" width="700">
</p>

---

## שימוש והוראות הפעלה

### ממשק משתמש (GUI)

1. הרץ את `main.py` כדי לפתוח את הממשק.
2. השתמש בממשק כדי:
   - **לטעון או ליצור תמונה מותאמת אישית.**
   - **לבחור הגדרות CRC ושיעור שגיאות.**
   - **לעבד ולנתח תוצאות.**

### רכיבי מפתח בממשק:
- **תמונה קלט**:
  - טעינת תמונת IAN או יצירת תמונה מותאמת אישית.
- **הגדרות CRC**:
  - הפעלת CRC (כן/לא).
- **שיעור שגיאות**:
  - קביעת שיעור הזרקת שגיאות (למשל ביט שגוי לכל N ביטים).

---

## איך להריץ את הפרויקט?

1. התקן את התלויות:  
   ```bash
   pip install -r requirements.txt
